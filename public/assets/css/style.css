:root {
  --font-sans: 'Inter', system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, sans-serif;
  --font-mono: 'Fira Code', 'Jetbrains Mono', ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;

  --radius: 0.75rem; /* 12px */
  --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
  --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -4px rgba(0, 0, 0, 0.1);

  --ease-in-out: cubic-bezier(0.4, 0, 0.2, 1);
  --transition-fast: 150ms var(--ease-in-out);
  --transition-normal: 250ms var(--ease-in-out);
}

.theme-light {
  --brand-50: #EFF6FF; --brand-100: #DBEAFE; --brand-500: #3B82F6; --brand-600: #2563EB;
  --bg: #F9FAFB; --surface: #FFFFFF; --surface-muted: #F3F4F6;
  --text: #111827; --text-muted: #6B7280; --text-subtle: #9CA3AF;
  --border: #E5E7EB; --border-hover: #D1D5DB;
  --success: #16A34A; --warning: #F59E0B; --danger: #DC2626;
  --shadow-color: 220 4% 59%;
}

.theme-dark {
  --brand-50: #1E293B; --brand-100: #334155; --brand-500: #60A5FA; --brand-600: #3B82F6;
  --bg: #030712; --surface: #111827; --surface-muted: #1F2937;
  --text: #F9FAFB; --text-muted: #9CA3AF; --text-subtle: #6B7280;
  --border: #374151; --border-hover: #4B5563;
  --success: #22C55E; --warning: #F59E0B; --danger: #EF4444;
  --shadow-color: 220 4% 2%;
}

@media (prefers-color-scheme: dark) {
  .theme-auto {
    --brand-50: #1E293B; --brand-100: #334155; --brand-500: #60A5FA; --brand-600: #3B82F6;
    --bg: #030712; --surface: #111827; --surface-muted: #1F2937;
    --text: #F9FAFB; --text-muted: #9CA3AF; --text-subtle: #6B7280;
    --border: #374151; --border-hover: #4B5563;
    --success: #22C55E; --warning: #F59E0B; --danger: #EF4444;
    --shadow-color: 220 4% 2%;
  }
}

@media (prefers-color-scheme: light) {
  .theme-auto {
    --brand-50: #EFF6FF; --brand-100: #DBEAFE; --brand-500: #3B82F6; --brand-600: #2563EB;
    --bg: #F9FAFB; --surface: #FFFFFF; --surface-muted: #F3F4F6;
    --text: #111827; --text-muted: #6B7280; --text-subtle: #9CA3AF;
    --border: #E5E7EB; --border-hover: #D1D5DB;
    --success: #16A34A; --warning: #F59E0B; --danger: #DC2626;
    --shadow-color: 220 4% 59%;
  }
}

*, *::before, *::after { box-sizing: border-box; }
html, body {
  margin: 0; padding: 0; background: var(--bg); color: var(--text);
  font-family: var(--font-sans); font-size: 16px; line-height: 1.5;
  -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale;
}
h1,h2,h3,h4 { margin: 0; font-weight: 600; }
a { color: var(--brand-500); text-decoration: none; }
a:hover { text-decoration: underline; }

/* LAYOUT */
.container { display: grid; grid-template-columns: auto 1fr; grid-template-rows: auto 1fr; height: 100vh; gap: 1rem; padding: 1rem; }
.header { grid-column: 1 / -1; display: flex; align-items: center; justify-content: space-between; }
.sidebar { grid-row: 2 / 3; }
.main-content { grid-column: 2 / 3; grid-row: 2 / 3; display: flex; flex-direction: column; gap: 1rem; overflow-y: auto; }
.content-panel { display: none; flex-direction: column; gap: 1rem; }
.content-panel[aria-hidden="false"], .content-panel:not([aria-hidden]) { display: flex; }
.panel-header { display: flex; justify-content: space-between; align-items: center; }
.panel-title { font-size: 1.5rem; }

/* HEADER */
.brand { display: flex; align-items: center; gap: 0.75rem; }
.brand__logo { height: 40px; }
.brand__title { font-size: 1.25rem; font-weight: 700; }
.toolbar { display: flex; gap: 0.5rem; }
.toolbar__group { display: flex; gap: 0.5rem; }

/* SIDEBAR & NAVIGATION */
.tab-navigation { display: flex; flex-direction: column; gap: 0.5rem; }
.tab {
  display: flex; align-items: center; gap: 0.75rem;
  padding: 0.75rem 1rem; border: 0; border-radius: var(--radius);
  background: transparent; color: var(--text-muted);
  font-size: 0.95rem; font-weight: 500; text-align: left;
  cursor: pointer; transition: all var(--transition-fast);
}
.tab:hover { background: var(--surface-muted); color: var(--text); }
.tab[aria-selected="true"] { background: var(--brand-50); color: var(--brand-600); }

/* FORMS & BUTTONS */
.btn {
  display: inline-flex; align-items: center; justify-content: center; gap: 0.5rem;
  padding: 0.6rem 1rem; border-radius: var(--radius);
  background: var(--brand-500); color: white; border: 1px solid transparent;
  font-weight: 500; cursor: pointer; transition: all var(--transition-fast);
}
.btn:hover { background: var(--brand-600); }
.btn--secondary {
  background: var(--surface); color: var(--text);
  border-color: var(--border);
}
.btn--secondary:hover { background: var(--surface-muted); border-color: var(--border-hover); }
.btn--danger { background: var(--danger); }
.btn--icon { padding: 0.6rem; }
.btn--sm { font-size: 0.875rem; padding: 0.4rem 0.8rem; }
.icon { width: 1.25rem; height: 1.25rem; }
.input, .select {
  width: 100%; padding: 0.6rem 0.8rem;
  background: var(--surface); border: 1px solid var(--border);
  color: var(--text); border-radius: var(--radius);
  transition: all var(--transition-fast);
}
.input:focus, .select:focus { border-color: var(--brand-500); box-shadow: 0 0 0 3px var(--brand-100); outline: none; }
.sr-only { position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); white-space: nowrap; border: 0; }

/* LIBRARY */
.search-bar { display: flex; flex: 1; max-width: 400px; }
.search-bar .input { border-top-right-radius: 0; border-bottom-right-radius: 0; }
.search-bar .btn { border-top-left-radius: 0; border-bottom-left-radius: 0; }
.filters { display: flex; gap: 0.75rem; align-items: center; flex-wrap: wrap; }
.filter-group { display: flex; gap: 0.75rem; }
.advanced-search-details { position: relative; }
.advanced-filters-body {
  position: absolute; top: 100%; right: 0; z-index: 10;
  width: 500px; padding: 1rem; margin-top: 0.5rem;
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); box-shadow: var(--shadow-lg);
}
.search-actions { display: flex; justify-content: flex-end; gap: 0.5rem; margin-top: 1rem; }
.quick-filters { display: flex; gap: 0.5rem; flex-wrap: wrap; }
.library { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 1rem; }

/* CARDS */
.card {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 1rem;
  box-shadow: var(--shadow-sm);
}
.skill {
  padding: 1rem; cursor: grab; transition: all var(--transition-normal);
  display: flex; flex-direction: column; gap: 0.5rem;
}
.skill:hover { transform: translateY(-2px); box-shadow: var(--shadow-md); }
.skill__code { font-family: var(--font-mono); font-size: 0.8rem; color: var(--text-subtle); }
.skill__theme { font-weight: 600; }
.skill__desc { font-size: 0.9rem; color: var(--text-muted); }
.skill__actions { display: flex; gap: 0.5rem; margin-top: auto; padding-top: 0.5rem; }

/* WORKSPACE */
.dropzones { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; }
.dropzone {
  background: var(--surface-muted); border: 2px dashed var(--border);
  border-radius: var(--radius); padding: 1rem;
  min-height: 200px;
}
.dropzone h4 { margin-bottom: 0.75rem; }
.dropped-item {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: 0.5rem; padding: 0.75rem;
  margin-bottom: 0.5rem; cursor: grab;
  display: flex; justify-content: space-between; align-items: center;
  box-shadow: var(--shadow-sm);
}
.template-section .section-title { margin-bottom: 1rem; }
.template-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 1rem; }
.template-card {
  display: flex; flex-direction: column; align-items: center; text-align: center;
  gap: 0.5rem; padding: 1rem; border: 2px solid var(--border);
  border-radius: var(--radius); cursor: pointer; transition: all var(--transition-normal);
}
.template-card:hover { border-color: var(--brand-500); transform: translateY(-2px); box-shadow: var(--shadow-md); }
.template-icon { font-size: 1.75rem; }
.template-title { font-weight: 600; }
.template-desc { font-size: 0.8rem; color: var(--text-muted); }
.workspace-prefs { display: grid; grid-template-columns: 1fr 1fr; gap: 2rem; }
.workspace-prefs .grid-3 { grid-template-columns: 1fr; } /* Stack on small screens */

/* MODALS */
.modal {
  position: fixed; inset: 0; display: none;
  background: rgba(0, 0, 0, 0.5); backdrop-filter: blur(4px);
  align-items: center; justify-content: center; z-index: 100;
}
.modal[open] { display: flex; }
.dialog {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: var(--radius); padding: 1.5rem;
  max-width: 520px; width: 92%; box-shadow: var(--shadow-lg);
}
.dialog-actions { margin-top: 1.5rem; display: flex; justify-content: flex-end; gap: 0.5rem; }

/* RESPONSIVENESS */
@media (max-width: 1024px) {
  .container { grid-template-columns: 1fr; grid-template-rows: auto auto 1fr; padding: 0.5rem; }
  .sidebar { grid-row: 2; }
  .tab-navigation { flex-direction: row; overflow-x: auto; }
  .tab { flex-shrink: 0; }
  .tab span { display: none; } /* Hide text on small screens */
  .main-content { grid-column: 1; grid-row: 3; }
  .panel-header { flex-direction: column; align-items: flex-start; gap: 0.5rem; }
  .search-bar { max-width: none; }
  .workspace-prefs { grid-template-columns: 1fr; }
  .dropzones { grid-template-columns: 1fr; }
}

@media (max-width: 768px) {
  .header {
    flex-direction: row;
    flex-wrap: wrap;
    gap: 0.5rem;
  }
  .brand { flex: 1 1 auto; }
  .brand__title { display: none; }
  .toolbar {
    width: auto;
    flex: 1 1 auto;
    justify-content: flex-end;
  }
  .filters { flex-direction: column; align-items: stretch; }
  .advanced-filters-body { width: calc(100vw - 2rem); }

  .tab { padding: 0.75rem; }
  .tab .icon { font-size: 1.5rem; }
}

/* UTILITIES */
.grid { display: grid; gap: 1rem; }
.grid-2 { grid-template-columns: 1fr 1fr; }
.grid-3 { grid-template-columns: 1fr 1fr 1fr; }
.grid-4 { grid-template-columns: 1fr 1fr 1fr 1fr; }

/* Back to Top Button */
.back-to-top {
  position: fixed; bottom: 20px; right: 20px;
  width: 48px; height: 48px;
  background: var(--brand-500); color: white;
  border: none; border-radius: 50%;
  cursor: pointer; z-index: 1000; box-shadow: var(--shadow-md);
  opacity: 0; visibility: hidden; transform: translateY(20px);
  transition: all var(--transition-normal);
}
.back-to-top.visible { opacity: 1; visibility: visible; transform: translateY(0); }
.back-to-top:hover { background: var(--brand-600); transform: translateY(-2px); }

/* Toast Notifications */
.toast-container { position: fixed; top: 20px; right: 20px; z-index: 10000; display: flex; flex-direction: column; gap: 8px; max-width: 350px; }
.toast { background: var(--surface); border: 1px solid var(--border); border-radius: var(--radius); padding: 12px 16px; box-shadow: var(--shadow-lg); display: flex; align-items: center; gap: 12px; transform: translateX(400px); opacity: 0; transition: all 0.3s ease; pointer-events: none; }
.toast.show { transform: translateX(0); opacity: 1; pointer-events: auto; }
.toast--success { border-left: 4px solid var(--success); }
.toast--error { border-left: 4px solid var(--danger); }
.toast--warning { border-left: 4px solid var(--warning); }
.toast--info { border-left: 4px solid var(--brand-500); }
